# **Re:Uniform ç³»çµ±é–‹ç™¼è¦æ ¼æ›¸ (Hackathon Version)**

## **1. å°ˆæ¡ˆæ¦‚è¿° (Project Overview)**

å°ˆæ¡ˆåç¨±ï¼šRe:Uniform  
æ ¸å¿ƒç›®æ¨™ï¼šå»ºç«‹ä¸€å€‹ Mobile-First çš„éŸ¿æ‡‰å¼ç¶²é ï¼Œåˆ©ç”¨ AI è¦–è¦ºè¾¨è­˜ç°¡åŒ–äºŒæ‰‹åˆ¶æœä¸Šæ¶æµç¨‹ï¼Œä¸¦åˆ©ç”¨ NLP è‡ªç„¶èªè¨€è™•ç†å„ªåŒ–æœå°‹é«”é©—ã€‚æ•´åˆ LINE Login èˆ‡ LIFFï¼Œæä¾›æµæš¢çš„ä½¿ç”¨è€…é«”é©—ã€‚  
é–‹ç™¼ç­–ç•¥ï¼šä½¿ç”¨è¼•é‡åŒ–ã€ç„¡ä¼ºæœå™¨æ¶æ§‹ï¼Œä»¥ Google ç”Ÿæ…‹ç³» (Sheets, App Script) æ­é… Cloudinary èˆ‡ Gemini/OpenAI å¿«é€Ÿæ§‹å»º MVPã€‚

## **2. ä½¿ç”¨è€…æ•…äº‹ (User Stories)**

ç³»çµ±æ ¸å¿ƒé‚è¼¯åˆ†ç‚ºå…©å¤§è·¯å¾‘ï¼Œä¸¦é€é LINE å¸³è™Ÿé€²è¡Œèº«ä»½é©—è­‰ï¼š

### **Story A: è³£å®¶/æè´ˆè€… (The Seller)**

*"æˆ‘æ˜¯ä¸€å€‹å¿™ç¢Œçš„å®¶é•·ï¼Œå®¶è£¡æœ‰ä¸€å †å°å­©ç©¿ä¸ä¸‹çš„åˆ¶æœï¼Œæˆ‘æƒ³å¿«é€Ÿæ¸…ç†å®ƒå€‘ï¼Œä¸æƒ³èŠ±æ™‚é–“å¡«è¡¨æ ¼ã€‚"*

* **æµç¨‹**ï¼š  
  1. ä½¿ç”¨è€…åœ¨é¦–é é»æ“Š **ã€ŒğŸ“¸ æˆ‘è¦è³£ (AI ä¸Šæ¶)ã€**ã€‚  
  2. è‹¥æœªç™»å…¥ï¼Œç³»çµ±å¼•å°é€²è¡Œ LINE ç™»å…¥ã€‚
  3. ç³»çµ±é–‹å•Ÿç›¸æ©Ÿï¼Œä½¿ç”¨è€…æ‹æ”åˆ¶æœç…§ç‰‡ã€‚  
  4. é¡¯ç¤º "AI åˆ†æä¸­..." Loading å‹•ç•«ã€‚  
  5. **AI è‡ªå‹•å¡«å¯«**ï¼šå­¸æ ¡ã€æ¬¾å¼ã€å°ºå¯¸ã€æ–°èˆŠç‹€æ³ã€å»ºè­°å”®åƒ¹ã€‚  
  6. ä½¿ç”¨è€…æª¢è¦–è‰ç¨¿ï¼Œé»æ“Š **ã€Œç¢ºèªä¸Šæ¶ã€**ã€‚  
  7. é¡¯ç¤ºæˆåŠŸç•«é¢ï¼Œä¸¦å¯åœ¨å€‹äººé é¢æŸ¥çœ‹å·²ä¸Šæ¶å•†å“ã€‚

### **Story B: è²·å®¶/æœå°‹è€… (The Buyer)**

*"æˆ‘æ­£åœ¨æ‰¾ç‰¹å®šå­¸æ ¡çš„åˆ¶æœï¼Œä½†æˆ‘ä¸çŸ¥é“ç¢ºåˆ‡å°ºå¯¸ï¼Œåªæƒ³ç”¨ç™½è©±æ–‡æœå°‹ã€‚å¦‚æœæ²’è²¨ï¼Œå¸Œæœ›æœ‰è²¨æ™‚é€šçŸ¥æˆ‘ã€‚"*

* **æµç¨‹**ï¼š  
  1. ä½¿ç”¨è€…åœ¨é¦–é æœå°‹æ¡†è¼¸å…¥è‡ªç„¶èªè¨€ï¼š**ã€Œæˆ‘è¦æ‰¾æµ·å±±åœ‹å°ä¸‰å¹´ç´šå¥³ç”Ÿçš„é‹å‹•æœã€**ã€‚  
  2. **AI è§£æ**ï¼šç³»çµ±è‡ªå‹•åˆ†æå‡º å­¸æ ¡:æµ·å±±åœ‹å°ã€å°ºå¯¸:130-140cmã€é¡åˆ¥:é‹å‹•æœã€‚  
  3. **æƒ…å¢ƒ 1 (æœ‰è²¨)**ï¼šé¡¯ç¤ºç¬¦åˆçš„å•†å“åˆ—è¡¨ã€‚ä½¿ç”¨è€…ç™»å…¥å¾Œå¯æŸ¥çœ‹è³£å®¶è¯çµ¡è³‡è¨Šã€‚
  4. **æƒ…å¢ƒ 2 (ç„¡è²¨)**ï¼šåˆ—è¡¨ç‚ºç©ºï¼Œç³»çµ±é¡¯ç¤º **ã€ŒğŸ”” ç›®å‰ç¼ºè²¨ï¼ŒåŠ å…¥é ç´„é€šçŸ¥ï¼Ÿã€** æŒ‰éˆ•ã€‚  
  5. ä½¿ç”¨è€…ç™»å…¥å¾Œé»æ“ŠåŠ å…¥ï¼Œç³»çµ±å°‡éœ€æ±‚å­˜å…¥ Waitlistã€‚

## **3. æŠ€è¡“å †ç–Š (Tech Stack)**

è«‹ä½¿ç”¨ä»¥ä¸‹æŠ€è¡“é€²è¡Œé–‹ç™¼ï¼š

### **Frontend (Hosting: GitHub Pages)**

* **Framework**: React 19 with Vite build tool.  
* **Language**: JavaScript (ES6+) with JSX.  
* **Styling**: Tailwind CSS (integrated via npm).  
* **Routing**: React Router DOM for SPA navigation.  
* **Authentication**: LINE Login (OAuth 2.0) & LIFF SDK.
* **Hosting**: GitHub Pages (deployed via `gh-pages` package to `gh-pages` branch).
* **Deployment**: `npm run deploy` (è‡ªå‹• build ä¸¦éƒ¨ç½²åˆ° GitHub Pages).

### **Backend (Google Apps Script)**

* **Logic**: Google Apps Script (GAS) éƒ¨ç½²ç‚º Web App (doGet, doPost).  
* **Database**: Google Sheets (ä½œç‚ºè³‡æ–™åº«).  
* **Image Storage**: Cloudinary (ç”¨æ–¼å„²å­˜åœ–ç‰‡ï¼Œæä¾› CDN åŠ é€Ÿèˆ‡å„ªåŒ–).
* **AI Integration**: ç›´æ¥åœ¨ GAS ä¸­å‘¼å« OpenAI API.  
* **Security**: API Keys (OpenAI, Cloudinary, LINE) å„²å­˜åœ¨ GAS Script Properties ä¸­.

### **AI Models**

* **Vision**: OpenAI gpt-4o-mini (ç”¨æ–¼ Story A: è¾¨è­˜åˆ¶æœåœ–ç‰‡).  
* **NLP**: OpenAI gpt-4o-mini (ç”¨æ–¼ Story B: è§£ææœå°‹èªæ„).
* **API Key Storage**: Script Properties (åœ¨ GAS ä¸­è¨­å®š `OPENAI_API_KEY`).

## **4. ç³»çµ±æ¶æ§‹ (Architecture)**

Data Flow:  
\[React App (GitHub Pages)\] \--(fetch POST)--\> \[GAS Web App URL\]  
  â”œâ”€> \[LINE Platform\] (èº«åˆ†é©—è­‰ & LIFF)
  â””â”€> \[Cloudinary\] (åœ–ç‰‡å„²å­˜ & CDN)  
  â””â”€> \[OpenAI API\] (åœ–ç‰‡è¾¨è­˜ & NLP)  
  â””â”€> \[Google Sheets\] (è³‡æ–™åº«)

1. **å‰ç«¯ (React)**ï¼šè² è²¬ UI å‘ˆç¾ã€æ‹ç…§ã€LIFF æ•´åˆã€‚ä½¿ç”¨ React Router é€²è¡Œé é¢è·¯ç”±ã€‚  
2. **å¾Œç«¯ (GAS)**ï¼š
   - `Code.gs`: ä¸»è¦ API å…¥å£èˆ‡æ¥­å‹™é‚è¼¯ã€‚
   - `LineAuthHelper.gs`: è™•ç† LINE ç™»å…¥é©—è­‰èˆ‡ä½¿ç”¨è€…è³‡æ–™ç®¡ç†ã€‚
   - `CloudinaryHelper.gs`: è™•ç†åœ–ç‰‡ä¸Šå‚³ã€‚
3. **åœ–ç‰‡å„²å­˜ (Cloudinary)**ï¼šä½¿ç”¨ Cloudinary API (Unsigned Upload)ï¼Œå°‡ Base64 åœ–ç‰‡ä¸Šå‚³ä¸¦å–å¾— Secure URLï¼Œå†å­˜å…¥ Sheetsã€‚  
4. **è³‡æ–™åº« (Sheets)**ï¼šæ¯å€‹ Tab ä»£è¡¨ä¸€å€‹è³‡æ–™è¡¨ï¼Œå„²å­˜å•†å“è³‡è¨Šã€é ç´„æ¸…å–®èˆ‡ä½¿ç”¨è€…è³‡æ–™ã€‚

## **5. è³‡æ–™åº«è¨­è¨ˆ (Google Sheets Structure)**

è«‹åœ¨ Google Sheet ä¸­å»ºç«‹ä»¥ä¸‹ä¸‰å€‹å·¥ä½œè¡¨ (Tabs)ï¼š

### **Tab 1: Items (å•†å“è¡¨ - æ”¯æ´ Story A)**

| id | seller_id | school | type | gender | size | conditions | condition_score | defects | status | image_url | created_at |
| :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- |
| *item_123* | *U123456* | *æ–°åŒ—å¸‚æ¿æ©‹å€æµ·å±±åœ‹å°* | *sport_top* | *F* | *140* | *150å…ƒ* | *4* | *ç„¡æ˜é¡¯ç‘•ç–µ* | *published* | *https://res.cloudinary.com/...* | *2025-11-27* |

### **Tab 2: Waitlist (é ç´„å–® - æ”¯æ´ Story B)**

| id | requester_id | target_school | target_type | target_size | status | created_at |
| :---- | :---- | :---- | :---- | :---- | :---- | :---- |
| *wait_456* | *U789012* | *æµ·å±±åœ‹å°* | *dress* | *130* | *active* | *2025-11-27* |

### **Tab 3: Users (ä½¿ç”¨è€… - LINE Login)**

| line_user_id | display_name | picture_url | contact_info | created_at | last_login |
| :---- | :---- | :---- | :---- | :---- | :---- |
| *U123456* | *æ—çˆ¸çˆ¸* | *https://profile...* | *Line: lin_papa* | *2025-11-27* | *2025-11-28* |

## **6. å¾Œç«¯ API è¨­è¨ˆ (Google Apps Script)**

è«‹åƒè€ƒ `backend/Code.gs` å’Œ `backend/LineAuthHelper.gs` çš„å®Œæ•´å¯¦ä½œã€‚

**Script Properties è¨­å®š**ï¼š

1. åœ¨ Google Apps Script Editor ä¸­: **è¨­å®š** (âš™ï¸) â†’ **Script Properties**  
2. å¿…é ˆè¨­å®šä»¥ä¸‹å±¬æ€§:  
   - `OPENAI_API_KEY`: OpenAI API Key (sk-...)  
   - `CLOUDINARY_CLOUD_NAME`: Cloudinary Cloud Name  
   - `CLOUDINARY_API_KEY`: Cloudinary API Key  
   - `CLOUDINARY_API_SECRET`: Cloudinary API Secret
   - `LINE_CHANNEL_ID`: LINE Login Channel ID
   - `LINE_CHANNEL_SECRET`: LINE Login Channel Secret

### **API Actions:**

#### **Action 1: uploadItem (Story A - ä¸Šå‚³åœ–ç‰‡)**
* **Input**: `{ "action": "uploadItem", "imageBase64": "..." }`  
* **Output**: `{ "status": "success", "data": { ...item_details } }`

#### **Action 2: analyzeItem (Story A - AI åˆ†æ)**
* **Input**: `{ "action": "analyzeItem", "imageBase64": "..." }`  
* **Output**: `{ "status": "success", "data": { ...item_details, "image_url": "..." } }`

#### **Action 3: publishItem (Story A - ç™¼å¸ƒå•†å“)**
* **Input**: `{ "action": "publishItem", "id": "...", "sellerId": "...", ... }`  
* **Logic**: éœ€é©—è­‰ sellerId æ˜¯å¦å­˜åœ¨ã€‚
* **Output**: `{ "status": "success", "data": ... }`

#### **Action 4: searchItems (Story B - æœå°‹)**
* **Input**: `{ "action": "searchItems", "query": "..." }`  
* **Output**: `{ "status": "success", "results": [...], "suggestWaitlist": boolean }`

#### **Action 5: addToWaitlist (Story B - åŠ å…¥é ç´„)**
* **Input**: `{ "action": "addToWaitlist", "requesterId": "...", ... }`  
* **Output**: `{ "status": "success" }`

#### **Action 6: registerLiffUser (Auth - LIFF è¨»å†Š)**
* **Input**: `{ "action": "registerLiffUser", "profile": { "line_user_id": "...", ... } }`
* **Logic**: è¨»å†Šæ–°ä½¿ç”¨è€…æˆ–æ›´æ–°ç¾æœ‰ä½¿ç”¨è€…è³‡æ–™ã€‚
* **Output**: `{ "status": "success", "data": { ...user_data } }`

#### **Action 7: verifyLineLogin (Auth - Web Login)**
* **Input**: `{ "action": "verifyLineLogin", "code": "...", "redirect_uri": "..." }`
* **Output**: `{ "status": "success", "data": { ...user_data } }`

#### **Action 8: User Data (Profile)**
* `getMyItems`: å–å¾—ç‰¹å®šä½¿ç”¨è€…çš„ä¸Šæ¶å•†å“ã€‚
* `getMyWaitlist`: å–å¾—ç‰¹å®šä½¿ç”¨è€…çš„é ç´„æ¸…å–®ã€‚
* `getItemContact`: å–å¾—å•†å“è³£å®¶çš„è¯çµ¡è³‡è¨Š (éœ€ç™»å…¥)ã€‚

## **7. å‰ç«¯é é¢è¦åŠƒ (React SPA)**

### **UI Sections (React Router):**

1. **Home View (`/`)**:  
   - Hero Section: "Re:Uniform" å¤§æ¨™é¡Œã€‚  
   - **Header**: é¡¯ç¤ºç™»å…¥æŒ‰éˆ•æˆ–ä½¿ç”¨è€…é ­åƒ (é€£çµè‡³ Profile)ã€‚
   - **æœ€è¿‘ä¸Šå‚³**: é¡¯ç¤ºæœ€æ–°å•†å“å¡ç‰‡ã€‚  
   - **æœ€è¿‘éœ€æ±‚**: é¡¯ç¤ºæœ€æ–°é ç´„éœ€æ±‚ã€‚  
   - **Story B å…¥å£**: Search Barã€‚  
   - **Story A å…¥å£**: Big Floating Button (ğŸ“¸ è³£åˆ¶æœ)ã€‚  

2. **Upload View (`/upload`)**:  
   - **Protected**: éœ€ç™»å…¥æ‰èƒ½è¨ªå•ã€‚
   - æ‹ç…§/ä¸Šå‚³ä»‹é¢ã€‚  
   - Loading State (AI åˆ†æä¸­)ã€‚  
   - ç·¨è¼¯/ç¢ºèªè¡¨å–®ã€‚  
   - ç™¼å¸ƒæˆåŠŸé é¢ã€‚  

3. **Result View (`/search`)**:  
   - æœå°‹çµæœåˆ—è¡¨ã€‚  
   - Empty State: é¡¯ç¤º [åŠ å…¥ç¼ºè²¨é ç´„] æŒ‰éˆ• (éœ€ç™»å…¥)ã€‚  

4. **UserProfile View (`/profile`)**:  
   - **Protected**: éœ€ç™»å…¥æ‰èƒ½è¨ªå•ã€‚
   - é¡¯ç¤ºä½¿ç”¨è€…åŸºæœ¬è³‡æ–™ (é ­åƒã€åç¨±)ã€‚
   - **æˆ‘çš„ä¸Šæ¶**: ç®¡ç†å·²ä¸Šæ¶å•†å“ã€‚
   - **æˆ‘çš„é ç´„**: æŸ¥çœ‹é ç´„ç‹€æ…‹ã€‚
   - ç™»å‡ºåŠŸèƒ½ã€‚

5. **Auth Callback (`/auth/callback`)**:
   - è™•ç† LINE Login Redirect å›èª¿ã€‚

## **8. é–‹ç™¼æ³¨æ„äº‹é …**

1. **Cloudinary Setup**:  
   - éœ€åœ¨ Cloudinary Dashboard å»ºç«‹ä¸€å€‹ **Unsigned Upload Preset**ã€‚  
   - å°‡ Cloud Name è¨­å®šåœ¨ GAS Script Propertiesã€‚

2. **LINE Login Setup**:
   - åœ¨ LINE Developers Console å»ºç«‹ LINE Login Channelã€‚
   - è¨­å®š Callback URL (Production & Localhost/ngrok)ã€‚
   - é–‹å•Ÿ LIFF App ä¸¦é—œè¯ Channelã€‚

3. **OpenAI Setup**:  
   - ç¢ºä¿ GAS Script Properties ä¸­æœ‰æœ‰æ•ˆçš„ `OPENAI_API_KEY`ã€‚  

4. **Testing**:
   - å¾Œç«¯æ¸¬è©¦ä½æ–¼ `backend/Code_test.gs` èˆ‡ `backend/LineAuthHelper_test.gs`ã€‚
   - æœ¬åœ°é–‹ç™¼ LIFF éœ€ä½¿ç”¨ `ngrok` æä¾› HTTPS URLã€‚